{# templates/article/new.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Nouvel Article{% endblock %}

{% block body %}
    <div class="container mt-5">
        <h1>Ajouter un nouvel article</h1>

        {{ form_start(form) }}
        <div class="form-group">
            {{ form_label(form.sourceId) }}
            {{ form_widget(form.sourceId) }}
            {{ form_errors(form.sourceId) }}
        </div>
        <div class="form-group">
            {{ form_label(form.name) }}
            {{ form_widget(form.name) }}
            {{ form_errors(form.name) }}
        </div>
        <div class="form-group">
            {{ form_label(form.content) }}
            {{ form_widget(form.content) }}
            {{ form_errors(form.content) }}
        </div>
        <div class="form-group">
            {{ form_label(form.publishedAt) }}
            {{ form_widget(form.publishedAt) }}
            {{ form_errors(form.publishedAt) }}
        </div>
        <div class="form-group">
            {{ form_widget(form.save) }}
        </div>
        {{ form_end(form) }}
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
    <script>
        $(function () {
            $('.datetimepicker').datetimepicker({
                format: 'ddd, DD MMM YYYY HH:mm:ss ZZ'
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.querySelector('form');
            const dateInput = form.querySelector('input[name="publishedAt"]');

            form.addEventListener('submit', function(event) {
                const dateValue = dateInput.value;
                const regex = /^\d{2}-\d{2}-\d{4}$/;

                if (!regex.test(dateValue)) {
                    alert('La date doit Ãªtre au format DD-MM-YYYY.');
                    event.preventDefault(); // Prevent form submission
                }
            });
        });
    </script>
{% endblock %}
